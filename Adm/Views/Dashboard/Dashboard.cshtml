@model List<Adm.ViewModel.ReproducoesViewModel>

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Administrador";
}

<div class="dashboard">
    <h2>Músicas Mais Reproduzidas</h2>

    @{
        var maxReproducao = Model.Any() ? Model.Max(m => m.Reproducao) : 1;
    }
    @foreach (var musica in Model.OrderByDescending(m => m.Reproducao).Take(5))
    {
        var largura = (int)((musica.Reproducao / (double)maxReproducao) * 100);

        <div class="label">@musica.Titulo (@musica.Reproducao reproduções)</div>
        <div class="barra">
            <div class="barra-preenchida" style="width:@largura%"></div>
        </div>
    }

    <h2>Artistas Mais Ouvidos</h2>

    @{
        var artistas = Model
            .GroupBy(m => m.NomeArtista)
            .Select(g => new {
                Nome = g.Key,
                Total = g.Sum(x => x.Reproducao)
            })
            .OrderByDescending(g => g.Total)
            .Take(5)
            .ToList();

        var maxArtista = artistas.Max(a => a.Total);
    }

    @foreach (var artista in artistas)
    {
        var largura = (int)((artista.Total / (double)maxArtista) * 100);

        <div class="label">@artista.Nome (@artista.Total reproduções)</div>
        <div class="barra">
            <div class="barra-preenchida" style="width:@largura%"></div>
        </div>
    }
</div>
